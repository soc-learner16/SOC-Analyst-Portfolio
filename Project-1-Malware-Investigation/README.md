
# SOC Investigation ‚Äì Suspicious mshta.exe Execution

## üìå Executive Summary

This project documents the investigation of a suspicious `mshta.exe` execution in a controlled lab environment using Sysmon telemetry. The activity simulated a Living-off-the-Land Binary (LOLBIN) attack scenario where mshta.exe was used to execute remote content.

The investigation identified:

- Suspicious process execution  
- Outbound network communication  
- File creation activity  
- Persistence via registry run key  

All findings were correlated into a timeline and mapped to MITRE ATT&CK techniques.

---

## üéØ Objective

To simulate and investigate a potential LOLBIN-based attack using `mshta.exe` and analyze endpoint telemetry using Sysmon logs.

---

## üß™ Lab Environment

- Windows 10 Virtual Machine  
- Sysmon installed and configured  
- Windows Event Viewer for log analysis  
- Controlled simulation (no real malware)  

---

## ‚öôÔ∏è Tools Used

- Sysmon  
- Windows Event Viewer  
- MITRE ATT&CK Framework  

---

## üîç Investigation Methodology

1. Generate suspicious activity using mshta.exe  
2. Monitor Sysmon logs for related events  
3. Identify process, network, file, and registry activity  
4. Correlate events into a timeline  
5. Map findings to MITRE ATT&CK  

---

## üïí Investigation Timeline

### 1Ô∏è‚É£ Process Execution
- **Event ID:** Sysmon 1  
- `mshta.exe` executed with suspicious command line  
- Parent-child process relationship analyzed  

---

### 2Ô∏è‚É£ Network Connection
- **Event ID:** Sysmon 3  
- Outbound connection observed from mshta.exe  
- Indicates possible payload retrieval or C2 communication  

---

### 3Ô∏è‚É£ File Creation
- **Event ID:** Sysmon 11  
- File dropped on system  
- Suggests payload staging  

---

### 4Ô∏è‚É£ Persistence Mechanism
- **Event ID:** Sysmon 13  
- Registry Run Key created  
- Indicates attempt to maintain persistence  

---

## üó∫ MITRE ATT&CK Mapping

| Technique | Description |
|---------|------------|
| T1218.005 | Mshta (Signed Binary Proxy Execution) |
| T1105 | Ingress Tool Transfer |
| T1547.001 | Registry Run Keys / Startup Folder |

---

## üö® Detection Opportunities

- Alert on mshta.exe executing remote URLs  
- Monitor outbound connections from mshta.exe  
- Detect registry run key creation for persistence  
- Investigate unusual parent-child process chains involving mshta.exe  

---

## üß† Lessons Learned

- LOLBins can be abused to evade defenses  
- Sysmon provides valuable endpoint visibility  
- Multi-event correlation is key in SOC investigations  
- Even simple tools can simulate realistic attack chains  

---

## üìÇ Evidence

Screenshots and logs are provided in the `/evidence` folder.

---

## ‚úÖ Conclusion

The investigation successfully identified suspicious activity consistent with LOLBIN abuse and persistence techniques. This project demonstrates practical SOC skills in endpoint log analysis, event correlation, and MITRE ATT&CK mapping.

---
