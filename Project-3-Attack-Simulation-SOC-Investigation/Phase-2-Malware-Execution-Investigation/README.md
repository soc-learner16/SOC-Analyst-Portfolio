# SOC Investigation Project – Phase 2  
## Malware Execution & Endpoint Investigation

---

## Project Overview

This project simulates execution of a suspicious executable in an isolated lab environment and demonstrates how a Security Operations Center (SOC) analyst detects, investigates, and contains malicious endpoint activity using telemetry logs.

The investigation replicates real SOC incident workflow including execution detection, behavioral analysis, network monitoring, and containment actions.

The goal is to demonstrate practical SOC investigation capabilities using structured analysis and professional incident documentation.

---

## Lab Environment

| Component | Description |
|------------|------------|
| Operating System | Windows Virtual Machine |
| Monitoring Tool | Sysmon |
| Log Analysis | Windows Event Viewer |
| Endpoint Protection | Windows Defender |
| Monitoring Utilities | Task Manager, Command Prompt |
| Environment Type | Isolated Virtual Lab |
| Sample Type | Controlled malware simulation sample |

All activity occurred within an isolated environment to avoid external impact.

---

## Attack Scenario

A suspicious executable was extracted and executed in a controlled environment to simulate endpoint compromise.

Endpoint telemetry revealed process execution, registry changes, process injection, DNS activity, and outbound network communication, consistent with malware behavior.

The malicious process was then contained and endpoint protections restored.

---

## Incident Investigation Timeline

| Stage | Description |
|--------|------------|
| Malware Acquisition | Suspicious archive extracted to obtain executable |
| Protection Disabled | Defender temporarily disabled for controlled execution |
| Malware Execution | Suspicious executable launched and logged |
| Registry Modification | Registry value changes detected |
| Process Injection | Code injected into legitimate process |
| DNS Activity | External domain lookups observed |
| Network Communication | Outbound connections detected |
| Containment | Suspicious process terminated |
| Recovery | Endpoint protection restored |

---

## Attack Flow Overview

```
Malware Extraction
        ↓
Malware Execution (Event ID 1)
        ↓
Registry Modification (Event ID 13)
        ↓
Process Injection (Event ID 8)
        ↓
DNS Queries (Event ID 22)
        ↓
Outbound Network Connections (Event ID 3)
        ↓
Process Termination (Event ID 5)
        ↓
Endpoint Protection Restored
```

---

## Investigation Workflow

### Malware Execution Detected
Sysmon Event ID 1 confirmed suspicious executable execution.

### Registry Modification Observed
Event ID 13 showed registry changes suggesting configuration modification.

### Process Injection Activity
Event ID 8 recorded injection into legitimate processes, indicating stealth behavior.

### DNS Queries Observed
Event ID 22 recorded domain resolution requests prior to network communication.

### Network Communication Detected
Event ID 3 revealed outbound connections to external IP addresses.

### Containment Action
Process manually terminated and activity stopped.

### Recovery Action
Endpoint protection restored following containment.

---

## Investigation Report

### Incident Summary
A suspicious executable was executed inside an isolated environment to simulate malware activity. Endpoint telemetry analysis revealed malicious behaviors including process execution, registry modification, process injection, DNS queries, and outbound network communication.

### Investigation Process
System logs were analyzed to identify abnormal behavior patterns, correlate events, and reconstruct attack sequence.

Telemetry revealed suspicious activity consistent with malware execution and command-and-control communication attempts.

### Findings
Investigation confirmed:

- Suspicious executable execution
- Registry modification behavior
- Process injection activity
- DNS resolution attempts
- Outbound network communication

These behaviors align with common malware execution techniques.

### Containment Actions
The malicious process was manually terminated and endpoint protection restored.

### Incident Outcome
Malicious activity was contained before persistence or lateral movement occurred.

---

## Indicators of Compromise (IOCs)

| IOC Type | Indicator |
|-----------|----------|
| Executable | Suspicious executable executed from user directory |
| DNS Queries | api.ipify.org |
| DNS Queries | ip-api.com |
| DNS Queries | labdexter.net |
| Behavior | Process injection detected |
| Behavior | Registry modification observed |
| Behavior | Outbound network communication |

---

## MITRE ATT&CK Techniques Observed

| Technique ID | Technique |
|--------------|-----------|
| T1204 | User Execution |
| T1055 | Process Injection |
| T1112 | Modify Registry |
| T1071 | Application Layer Protocol Communication |

---

## Detection Logic

### Detection Opportunities

1. Suspicious Process Execution  
Executables running from user directories may indicate malicious activity.

2. Process Injection Detection  
Monitoring Event ID 8 helps identify injection attempts.

3. Registry Modification Monitoring  
Event ID 13 may indicate persistence attempts.

4. DNS Activity Monitoring  
Event ID 22 reveals suspicious domain resolution.

5. Outbound Network Connections  
Event ID 3 reveals suspicious communications.

---

### SOC Detection Strategy
Alerts may trigger when:

- Executable runs from user directory
AND
- Outbound connections occur shortly after execution
OR
- Process injection behavior occurs.

Combining indicators reduces false positives.

---

## SOC Analyst Findings

Telemetry analysis confirms:

- Suspicious executable execution
- Registry changes
- Code injection behavior
- DNS and network communication attempts

Endpoint telemetry enabled rapid containment.

---

## Incident Response Actions

1. Suspicious process identified
2. Process manually terminated
3. Endpoint protection restored
4. Evidence documented

System returned to safe state.

---

## Skills Demonstrated

- Endpoint telemetry investigation
- Sysmon event correlation
- Process behavior analysis
- Network activity investigation
- IOC identification
- Incident containment
- SOC investigation documentation

---

## Key Learning Outcomes

- Process injection is commonly used for stealth execution.
- DNS activity reveals external communication attempts.
- Registry changes may indicate persistence.
- Telemetry correlation accelerates detection and response.

---

## Project Structure

```
SOC-Analyst-Portfolio/
│
└── Project-3-Attack-Simulation-SOC-Investigation/
    │
    ├── Phase-1-Safe-Attack-Simulation/
    │   └── README.md
    │
    └── Phase-2-Malware-Execution-Investigation/
        │
        ├── README.md
        │
        └── Evidence/
            ├── 01_malware_extraction.png
            ├── 02_malware_sample_folder.png
            ├── 03_defender_disabled.png
            ├── 04_process_execution_sysmon.png
            ├── 05_registry_modification.png
            ├── 06_process_injection.png
            ├── 07_dns_query.png
            ├── 08_network_connection.png
            ├── 09_process_termination.png
            └── 10_defender_enabled.png
```

---

## Incident Outcome

Malicious activity was successfully detected, investigated, and contained. Endpoint protection was restored and no persistence remained.

---

## Project Result

A complete SOC investigation workflow was successfully simulated and documented, demonstrating practical endpoint detection and incident response skills applicable to real-world SOC environments.

---

## Analyst Note

All testing was conducted in an isolated environment for investigation and educational purposes only.

